---
title: "STAT230 Final Project"
author: "Noah, Alex, Lucas"
date: "2024-03-04"
output:
  pdf_document: default
  html_document: default
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(mosaic)
library(ggformula)
library(car)
library(GGally)
library(broom)
library(ggeffects)
library(effects)
library(tidyr)
library(ggplot2)
library(rms)
```


3 POINT ATTEMPTED UNIVARIATE PLOT:
- RIGHT SKEW
```{r}
gf_boxplot(~FG3A, data=final_data)
gf_histogram(~FG3A, data=final_data)
```

```{r}
gf_jitter(FG3A~SEASON, data=final_data) %>% gf_lm()
gf_jitter(pts_allowed~SEASON, data=final_data) %>% gf_lm()
```

```{r}
gf_jitter(FG3A~pts_allowed, data=final_data) %>% gf_lm()
```


MODEL:
```{r}
nba_glm <- glm(win ~ FG3A  + pts_allowed + FTA  + OREB + DREB + TO + SEASON, data = final_data, family = "binomial")
summary(nba_glm)
```

PLOTS:
win v 3PA:
```{r}
lm_preds <- ggpredict(nba_glm, terms = c("FG3A"))
plot(lm_preds, show_data = TRUE) + 
  labs(title="Predicted Probability of winning based on 3 points shot", x="3FGA", y="Predicted probability of winning")
```


win v pts allowed:
```{r}
lm_preds <- ggpredict(nba_glm, terms = c("pts_allowed"))
plot(lm_preds, show_data = TRUE) + 
  labs(title="Predicted Probability of winning based on pts_allowed", x="pts_allowed", y="Predicted probability of winning")
```
win v free throws attempted
```{r}
lm_preds <- ggpredict(nba_glm, terms = c("FTA"))
plot(lm_preds, show_data = TRUE) + 
  labs(title="Predicted Probability of winning based on FTA", x="FTA", y="Predicted probability of winning")
```
win v OREB
```{r}
lm_preds <- ggpredict(nba_glm, terms = c("OREB"))
plot(lm_preds, show_data = TRUE) + 
  labs(title="Predicted Probability of winning based on OREB", x="OREB", y="Predicted probability of winning")
```
win v DREB
```{r}
lm_preds <- ggpredict(nba_glm, terms = c("DREB"))
plot(lm_preds, show_data = TRUE) + 
  labs(title="Predicted Probability of winning based on DREB", x="DREB", y="Predicted probability of winning")
```
win v TO
```{r}
lm_preds <- ggpredict(nba_glm, terms = c("TO"))
plot(lm_preds, show_data = TRUE) + 
  labs(title="Predicted Probability of winning based on TO", x="TO", y="Predicted probability of winning")
```

```{r}
lm_preds <- ggpredict(nba_glm, terms = c("FG3A", "pts_allowed"))
plot(lm_preds, show_data = TRUE) + 
  labs(title="Predicted Probability of winning based on 3 points shot and points allowed", x="3FGA", y="Predicted probability of winning")
```


```{r}
p_lrm <- lrm(win ~ FG3A  + pts_allowed + FTA  + OREB + DREB + TO, data = final_data)
p_lrm$stats[c("Dxy", "Gamma", "Tau-a")]
```


